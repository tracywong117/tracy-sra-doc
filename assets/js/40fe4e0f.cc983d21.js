"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[127],{4137:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var i=a(4848),n=a(8453);const o={sidebar_position:4},r="4. Data Curation",s={id:"data-processing/data-curation",title:"4. Data Curation",description:"4.1 Attribute Key Curation",source:"@site/docs/data-processing/data-curation.md",sourceDirName:"data-processing",slug:"/data-processing/data-curation",permalink:"/tracy-sra-doc/docs/data-processing/data-curation",draft:!1,unlisted:!1,editUrl:"https://github.com/tracywong117/tracy-sra-doc/tree/main/docs/data-processing/data-curation.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"3. Useful Data",permalink:"/tracy-sra-doc/docs/data-processing/useful-data"}},c={},l=[{value:"4.1 Attribute Key Curation",id:"41-attribute-key-curation",level:2},{value:"4.1.1 Extract Region (Country/City) from Attributes",id:"411-extract-region-countrycity-from-attributes",level:3},{value:"4.1.2 Extract Geographical Location (Latitude, Longitude) from Attributes",id:"412-extract-geographical-location-latitude-longitude-from-attributes",level:3},{value:"4.1.3 Extract Collection Date from Attributes",id:"413-extract-collection-date-from-attributes",level:3},{value:"4.2 Convert Region (Country/City) into Latitude-Longitude Viewport",id:"42-convert-region-countrycity-into-latitude-longitude-viewport",level:2},{value:"4.3 Form the data",id:"43-form-the-data",level:2}];function d(e){const t={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,n.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h1,{id:"4-data-curation",children:"4. Data Curation"}),"\n",(0,i.jsx)(t.h2,{id:"41-attribute-key-curation",children:"4.1 Attribute Key Curation"}),"\n",(0,i.jsx)(t.p,{children:"We aim to keep only the searchable and meaningful attribute key-value pairs from the SRA dataset for easier viewing. With so many attributes, we start by gathering all unique attribute keys and sample values using this BigQuery script:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-sql",children:"SELECT\n  a.k AS key,\n  ANY_VALUE(a.v) AS sample_value,\n  COUNT(*) AS count,\n  ANY_VALUE(s.run_accession) AS example_accession_id\nFROM\n  `nih-sra-datastore.sra.metadata` AS s,\n  UNNEST(s.attributes) AS a\nGROUP BY\n  a.k\nORDER BY\n  count DESC\n"})}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Total unique keys:"})," 88,952"]}),"\n",(0,i.jsx)(t.p,{children:"Next, we process them in two steps:"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"clean_attribute_k.py"}),"\nThis script cleans each attribute key by removing endings like ",(0,i.jsx)(t.code,{children:"_sam"})," or ",(0,i.jsx)(t.code,{children:"_calc"}),", replacing underscores with spaces, and trimming extra spaces."]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"gemini_curate_attribute_k.py"}),"\nWe then pass the cleaned keys to a language model (LLM) to keep only those related to place (e.g., location, latitude/longitude), collection date, or sample details (e.g., tissue, isolation source, species, sex, age). Vague or irrelevant keys are discarded. For example, ",(0,i.jsx)(t.code,{children:"_370_nano2wt_deep_mixing_barcode_and_primer_exp"})," with a value of ",(0,i.jsx)(t.code,{children:"'CGACGTCGAG,TCCAGTTGATCCTGCGGG'"})," is removed because it\u2019s unclear and not searchable."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Prompt for the LLM:"}),(0,i.jsx)(t.br,{}),"\n",'"Clean the attribute keys from an SRA dataset to keep only those related to place (e.g., location, latitude/longitude), collection date, and sample information (e.g., tissue, isolation source, species, sex, age). Remove ambiguous or irrelevant keys that don\u2019t clearly fit these categories. Extract only the needed attribute keys from the list below and provide a short meaning for each, separated by a comma (e.g., collection date, date when the sample was collected). Output the result as text, with each key on a new line."']}),"\n",(0,i.jsxs)(t.p,{children:["In the end, we get a curated list of ",(0,i.jsx)(t.strong,{children:"4,703"})," attribute keys that are clear and tied to place, collection date, or sample information."]}),"\n",(0,i.jsx)(t.h3,{id:"411-extract-region-countrycity-from-attributes",children:"4.1.1 Extract Region (Country/City) from Attributes"}),"\n",(0,i.jsx)(t.p,{children:"We use an LLM to identify attribute keys related to regions (e.g., country, city) and extract them into SRA data fields for searching."}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Prompt for the LLM:"}),(0,i.jsx)(t.br,{}),"\n",'"From the SRA dataset attribute keys, extract only those related to region (e.g., country, city). Remove keys that are ambiguous or unrelated. Output the result as text, with each key on a new line."']}),"\n",(0,i.jsx)(t.h3,{id:"412-extract-geographical-location-latitude-longitude-from-attributes",children:"4.1.2 Extract Geographical Location (Latitude, Longitude) from Attributes"}),"\n",(0,i.jsx)(t.p,{children:"We use an LLM to identify attribute keys with geographical coordinates (latitude, longitude) and extract them into SRA data fields for searching."}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Prompt for the LLM:"}),(0,i.jsx)(t.br,{}),"\n",'"From the SRA dataset attribute keys, extract only those related to geographical location (e.g., latitude, longitude). Remove keys that are ambiguous or unrelated. Output the result as text, with each key on a new line."']}),"\n",(0,i.jsx)(t.h3,{id:"413-extract-collection-date-from-attributes",children:"4.1.3 Extract Collection Date from Attributes"}),"\n",(0,i.jsx)(t.p,{children:"We use an LLM to identify attribute keys tied to collection date and extract them into SRA data fields for searching."}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Prompt for the LLM:"}),(0,i.jsx)(t.br,{}),"\n",'"From the SRA dataset attribute keys, extract only those related to collection date. Remove keys that are ambiguous or unrelated. Output the result as text, with each key on a new line."']}),"\n",(0,i.jsx)(t.h2,{id:"42-convert-region-countrycity-into-latitude-longitude-viewport",children:"4.2 Convert Region (Country/City) into Latitude-Longitude Viewport"}),"\n",(0,i.jsx)(t.p,{children:"We use the Google Geocoding API to convert regions (e.g., country, city) into a latitude-longitude viewport, represented as two diagonally opposite points (low and high). This makes searching flexible across different levels. For example, if the data is tied to a town and someone searches for the city it belongs to, that data will still show up."}),"\n",(0,i.jsx)(t.h2,{id:"43-form-the-data",children:"4.3 Form the data"}),"\n",(0,i.jsxs)(t.p,{children:["We use ",(0,i.jsx)(t.code,{children:"extraction.py"})," to take the curated list of 4,703 attribute keys, along with the specific lists of keys related to regions, geographical coordinates, and collection dates, to create a simplified dataset. This script extracts and organizes the data into new or updated SRA fields: collection date, latitude, longitude, region, and viewport of region. These fields make the data more searchable and structured."]})]})}function u(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,t,a)=>{a.d(t,{R:()=>r,x:()=>s});var i=a(6540);const n={},o=i.createContext(n);function r(e){const t=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),i.createElement(o.Provider,{value:t},e.children)}}}]);